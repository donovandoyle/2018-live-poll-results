---
title: "Problem Set 7"
author: "Keeley MacAfee, Connor Sakmar, Donovan Doyle, Annabelle Paterson"
date: "11/18/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(plyr)
library(tidyverse)
library(foreign)
library(readxl)
library(stringr)
library(fs)
library(kableExtra)
library(formattable)
library(lubridate)
library(knitr)
library(janitor)
library(stringr)
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
download.file("https://goo.gl/ZRCBda",
              destfile = "Polls.zip",
              quiet = TRUE,
              mode = "wb")

unzip("Polls.zip")

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
x <- dir_ls("2018-live-poll-results-master/data")

polls <- map_dfr(x, read_csv, .id = "source")
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
download.file(url = "https://d1b10bmlvqabco.cloudfront.net/attach/jkjtds7xjxd3jy/jlr7wvzsace3kp/joc6wbypyxy7/mt_2_results.csv",
              destfile = "mt_2_results.csv")

schroeder_data <- read_csv("mt_2_results.csv")
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

polls_separate <-polls %>%
  select(source, response, ager, educ, gender, race_eth, race_edu) %>%
  mutate(neat = str_split(source, "-")) %>%
  separate(neat, into = c("c", "year", "live", "poll", "results", "master", "data", "elections", "poll_again", "state_district", "wave")) %>%
  select(state_district, response, wave, ager, educ, gender, race_eth, race_edu)

ca_polls <- polls_separate %>%
  separate(state_district, into = c("state", "district"), sep = 2) %>%
  filter(state == "ca") %>%
  filter(race_eth != "[DO NOT READ] Don't know/Refused") %>%
  filter(race_edu != "[DO NOT READ] Don't know/Refused") %>%
  filter(educ != "[DO NOT READ] Don't know/Refused") %>%
  filter(educ != "[DO NOT READ] Refused") %>%
  filter(ager != "[DO NOT READ] Don't know/Refused") %>%
  filter(ager != "[DO NOT READ] Refused") %>%
  filter(gender != "[DO NOT READ] Don't know/Refused") %>%
  filter(wave == "3")

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
ca_results <- schroeder_data %>%
  filter(state == "CA")

ca_results_clean <- ca_results[ c(10, 25, 39, 45, 48, 49), ]
```

